/**
 * LinkedIn Profile Scraper - Bookmarklet Version
 * 
 * INSTALLATION:
 * 1. Copy ALL the text below (starting with javascript:)
 * 2. Create a new bookmark in your browser
 * 3. Set the URL to the copied text
 * 4. Name it "LinkedIn Scraper"
 * 
 * USAGE:
 * 1. Navigate to LinkedIn people search results
 * 2. Click the bookmarklet
 * 3. Enter number of profiles to scrape
 * 4. Wait for completion
 * 5. Export results
 * 
 * Note: Due to length, this may not work in all browsers.
 * Use the console version if bookmarklet fails.
 */

javascript:(function()%7B'use%20strict'%3Bfunction%20getCsrfToken()%7Bconst%20cookies%20%3D%20document.cookie.split('%3B')%3Bfor(let%20cookie%20of%20cookies)%7Bconst%20%5Bname%2Cvalue%5D%20%3D%20cookie.trim().split('%3D')%3Bif(name%20%3D%3D%3D%20'JSESSIONID')%7Bconst%20cleanValue%20%3D%20value.replace(%2F%22%2Fg%2C'')%3Breturn%20decodeURIComponent(cleanValue)%3B%7D%7Dreturn%20null%3B%7Dfunction%20sanitizeProfileUrl(rawUrl)%7Bif(!rawUrl%20%7C%7C%20typeof%20rawUrl%20!%3D%3D%20'string')return%20null%3Bif(!rawUrl.startsWith('https%3Areturn%20null%3B%7Dconst%20url%20%3D%20new%20URL(rawUrl)%3Burl.search%20%3D%20''%3Bconst%20pathMatch%20%3D%20url.pathname.match(%2F%5E%5C%2Fin%5C%2F%5B%5E%5C%2F%5D%2B%5C%2F%3F%24%2F)%3Bif(!pathMatch)return%20null%3Breturn%20url.href%3B%7Dfunction%20parseFollowers(text)%7Bif(!text%20%7C%7C%20typeof%20text%20!%3D%3D%20'string')return%20null%3Bconst%20match%20%3D%20text.match(%2F(%5Cd%2B(%3F%3A%5C.%5Cd%2B)%3F)%5Cs*(%5BKMk%5D%3F)%5Cs*followers%3F%2Fi)%3Bif(!match)return%20null%3Blet%20number%20%3D%20parseFloat(match%5B1%5D)%3Bconst%20suffix%20%3D%20match%5B2%5D.toUpperCase()%3Bif(suffix%20%3D%3D%3D%20'K')%7Bnumber%20%3D%20number%20*%201000%3B%7Delse%20if(suffix%20%3D%3D%3D%20'M')%7Bnumber%20%3D%20number%20*%201000000%3B%7Dreturn%20Math.round(number)%3B%7Dfunction%20parseSummary(summaryText)%7Bif(!summaryText%20%7C%7C%20typeof%20summaryText%20!%3D%3D%20'string')%7Breturn%7Bcurrent%3A%5B%5D%2Cpast%3A%5B%5D%7D%3B%7Dconst%20lines%20%3D%20summaryText.split('%5Cn')%3Bconst%20result%20%3D%7Bcurrent%3A%5B%5D%2Cpast%3A%5B%5D%7D%3Bfor(let%20line%20of%20lines)%7Bif(line.startsWith('Current%3A'))%7Bconst%20companies%20%3D%20line.replace('Current%3A'%2C'').trim()%3Bresult.current%20%3D%20companies.split('%2C').map(c%20%3D%3E%20c.trim()).filter(c%20%3D%3E%20c)%3B%7Delse%20if(line.startsWith('Past%3A'))%7Bconst%20companies%20%3D%20line.replace('Past%3A'%2C'').trim()%3Bresult.past%20%3D%20companies.split('%2C').map(c%20%3D%3E%20c.trim()).filter(c%20%3D%3E%20c)%3B%7D%7Dreturn%20result%3B%7Dfunction%20isNoiseEntry(name)%7Bif(!name%20%7C%7C%20typeof%20name%20!%3D%3D%20'string')return%20true%3Bconst%20noisePatterns%20%3D%20%5B%20%2Fmutual%20connection%2Fi%2C%2FLinkedIn%20Member%2Fi%2C%2FView%20services%2Fi%2C%2FProvides%20services%2Fi%2C%2F%5EView%5Cs%2Fi%2C%2F%5ELinkedIn%5Cs%2Fi%20%5D%3Breturn%20noisePatterns.some(pattern%20%3D%3E%20pattern.test(name))%3B%7Dfunction%20normalizePerson(rawData)%7Bif(!rawData%20%7C%7C%20typeof%20rawData%20!%3D%3D%20'object')return%20null%3Blet%20name%20%3D%20rawData.title%3F.text%20%7C%7C%20rawData.name%20%7C%7C%20''%3Bconst%20followerMatch%20%3D%20name.match(%2F%5E(.*%3F)(%3F%3A%5Cs*%C2%B7%5Cs*.*followers%3F)%3F%24%2F)%3Bif(followerMatch)%7Bname%20%3D%20followerMatch%5B1%5D.trim()%3B%7Dif(isNoiseEntry(name))return%20null%3Bconst%20profileUrl%20%3D%20sanitizeProfileUrl(rawData.navigationUrl%20%7C%7C%20rawData.profileUrl%20%7C%7C%20rawData.url)%3Bconst%20headline%20%3D%20rawData.primarySubtitle%3F.text%20%7C%7C%20rawData.headline%20%7C%7C%20rawData.subtitle%20%7C%7C%20''%3Bconst%20location%20%3D%20rawData.secondarySubtitle%3F.text%20%7C%7C%20rawData.location%20%7C%7C%20''%3Blet%20followersText%20%3D%20''%3Bif(rawData.insights%20%26%26%20Array.isArray(rawData.insights))%7Bfor(let%20insight%20of%20rawData.insights)%7Bif(insight.text%20%26%26%20insight.text.includes('follower'))%7BfollowersText%20%3D%20insight.text%3Bbreak%3B%7D%7D%7Dif(!followersText%20%26%26%20rawData.title%3F.text)%7BfollowersText%20%3D%20rawData.title.text%3B%7Dconst%20followers%20%3D%20parseFollowers(followersText)%3Bconst%20summaryText%20%3D%20rawData.summary%3F.text%20%7C%7C%20rawData.summary%20%7C%7C%20''%3Bconst%20summary%20%3D%20parseSummary(summaryText)%3Bif(!name%20%26%26%20!headline)return%20null%3Breturn%7Bname%3Aname%2CprofileUrl%3AprofileUrl%2Cheadline%3Aheadline%2Clocation%3Alocation%2Cfollowers%3Afollowers%2CsummaryCurrent%3Asummary.current%2CsummaryPast%3Asummary.past%7D%3B%7Dfunction%20extractPeopleFromResponse(jsonResponse)%7Bconst%20people%20%3D%20%5B%5D%3Bconst%20seen%20%3D%20new%20Set()%3Bfunction%20traverse(obj)%7Bif(!obj%20%7C%7C%20typeof%20obj%20!%3D%3D%20'object')return%3Bif(Array.isArray(obj))%7Bobj.forEach(item%20%3D%3E%20traverse(item))%3Breturn%3B%7Dconst%20hasPersonIndicators%20%3D(obj.title%20%26%26%20obj.title.text)%7C%7C(obj.primarySubtitle%20%26%26%20obj.primarySubtitle.text)%7C%7C(obj.navigationUrl%20%26%26%20obj.navigationUrl.includes('%2Fin%2F'))%7C%7C(obj.entityUrn%20%26%26%20obj.entityUrn.includes('member'))%3Bif(hasPersonIndicators)%7Bconst%20person%20%3D%20normalizePerson(obj)%3Bif(person)%7Bconst%20key%20%3D%20person.profileUrl%20%7C%7C%20%60%24%7Bperson.name%7D%3A%24%7Bperson.headline%7D%60%3Bif(!seen.has(key))%7Bseen.add(key)%3Bpeople.push(person)%3B%7D%7D%7Dfor(let%20key%20in%20obj)%7Bif(obj.hasOwnProperty(key))%7Btraverse(obj%5Bkey%5D)%3B%7D%7D%7Dtraverse(jsonResponse)%3Breturn%20people%3B%7Dclass%20LinkedInScraper%7Bconstructor(targetCount%20%3D%20300%2Ckeyword%20%3D%20null)%7Bthis.targetCount%20%3D%20targetCount%3Bthis.keyword%20%3D%20keyword%20%7C%7C%20this.extractKeyword()%3Bthis.people%20%3D%20%5B%5D%3Bthis.seen%20%3D%20new%20Set()%3Bthis.ui%20%3D%20null%3Bthis.retryCount%20%3D%200%3Bthis.maxRetries%20%3D%203%3B%7DextractKeyword()%7Bconst%20urlParams%20%3D%20new%20URLSearchParams(window.location.search)%3Bconst%20keywords%20%3D%20urlParams.get('keywords')%3Bconsole.log('%3D%3D%3D%20URL%20PARAMETERS%20%3D%3D%3D')%3BurlParams.forEach((value%2Ckey)%3D%3E%7Bconsole.log(%60%24%7Bkey%7D%3A%24%7Bvalue%7D%60)%3B%7D)%3Bconsole.log('%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D')%3Bif(keywords)return%20keywords%3Bconst%20searchBox%20%3D%20document.querySelector('input%5Bplaceholder*%3D%22Search%22%5D')%3Bif(searchBox%20%26%26%20searchBox.value)return%20searchBox.value%3Breturn%20''%3B%7DbuildUrl(start)%7Bconst%20urlParams%20%3D%20new%20URLSearchParams(window.location.search)%3Bconsole.log('%3D%3D%3D%20Building%20LinkedIn%20API%20URL%20%3D%3D%3D')%3Bconsole.log('Current%20URL%3A'%2Cwindow.location.href)%3Bconst%20excludeParams%20%3D%20%5B%20'keywords'%2C'origin'%2C'sid'%2C'_sid'%2C'trk'%2C'_trk'%2C'lipi'%2C'lici'%20%5D%3Blet%20queryParamsList%20%3D%20%5B%5D%3BurlParams.forEach((value%2Ckey)%3D%3E%7Bif(!excludeParams.includes(key)%26%26%20value)%7Blet%20clean%20%3D%20value%3Bif(clean.startsWith('%5B')%26%26%20clean.endsWith('%5D'))%7Bclean%20%3D%20clean.slice(1%2C-1)%3B%7Dif(clean.startsWith('%22')%26%26%20clean.endsWith('%22'))%7Bclean%20%3D%20clean.slice(1%2C-1)%3B%7Dclean%20%3D%20clean.replace(%2F%22%2Fg%2C'')%3BqueryParamsList.push('(key%3A'%20%2B%20key%20%2B%20'%2Cvalue%3AList('%20%2B%20clean%20%2B%20'))')%3Bconsole.log('Added%20parameter%3A'%2Ckey%2C'%3D'%2Cclean)%3B%7D%7D)%3BqueryParamsList.push('(key%3AresultType%2Cvalue%3AList(PEOPLE))')%3Bconst%20queryParameters%20%3D%20'List('%20%2B%20queryParamsList.join('%2C')%2B%20')'%3Bconst%20variables%20%3D%20'variables%3D(start%3A'%20%2B%20start%20%2B%20'%2Corigin%3AFACETED_SEARCH'%20%2B%20'%2Cquery%3A(keywords%3A'%20%2B%20encodeURIComponent(this.keyword)%2B%20'%2CflagshipSearchIntent%3ASEARCH_SRP'%20%2B%20'%2CqueryParameters%3A'%20%2B%20queryParameters%20%2B%20'%2CincludeFiltersInResponse%3Afalse))'%3Bconst%20queryId%20%3D%20'queryId%3DvoyagerSearchDashClusters.15c671c3162c043443995439a3d3b6dd'%3Bconst%20finalUrl%20%3D%20'https%3Aconsole.log('Final%20URL%3A'%2CfinalUrl)%3Bconsole.log('%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D%3D')%3Breturn%20finalUrl%3B%7Dasync%20delay(min%20%3D%20400%2Cmax%20%3D%201100)%7Bconst%20ms%20%3D%20Math.floor(Math.random()*(max%20-%20min%20%2B%201))%2B%20min%3Breturn%20new%20Promise(resolve%20%3D%3E%20setTimeout(resolve%2Cms))%3B%7Dasync%20fetchPage(start)%7Bconst%20url%20%3D%20this.buildUrl(start)%3Bconst%20csrfToken%20%3D%20getCsrfToken()%3Bconst%20headers%20%3D%7B'x-restli-protocol-version'%3A'2.0.0'%2C'Accept'%3A'application%2Fjson'%7D%3Bif(csrfToken)%7Bheaders%5B'csrf-token'%5D%20%3D%20csrfToken%3B%7Dtry%7Bconsole.log(%60Fetching%20page%20starting%20at%20%24%7Bstart%7D...%60)%3Bconsole.log(%60URL%3A%24%7Burl%7D%60)%3Bconst%20response%20%3D%20await%20fetch(url%2C%7Bmethod%3A'GET'%2Cheaders%3Aheaders%2Ccredentials%3A'include'%7D)%3Bif(response.status%20%3D%3D%3D%20429)%7Bthrow%20new%20Error('RATE_LIMIT')%3B%7Dif(!response.ok)%7Bconsole.error(%60Fetch%20error%3AHTTP%20%24%7Bresponse.status%7D%60)%3Bthrow%20new%20Error(%60HTTP%20%24%7Bresponse.status%7D%60)%3B%7Dconst%20data%20%3D%20await%20response.json()%3Bconst%20newPeople%20%3D%20extractPeopleFromResponse(data)%3Blet%20addedCount%20%3D%200%3Bfor(let%20person%20of%20newPeople)%7Bconst%20key%20%3D%20person.profileUrl%20%7C%7C%20%60%24%7Bperson.name%7D%3A%24%7Bperson.headline%7D%60%3Bif(!this.seen.has(key))%7Bthis.seen.add(key)%3Bthis.people.push(person)%3Bif(this.ui)%7Bthis.ui.addRow(person)%3B%7DaddedCount%2B%2B%3B%7D%7Dconsole.log(%60Found%20%24%7BaddedCount%7Dnew%20profiles(Total%3A%24%7Bthis.people.length%7D)%60)%3Breturn%20addedCount%20%3E%200%3B%7Dcatch(error)%7Bif(error.message%20%3D%3D%3D%20'RATE_LIMIT')%7Bthrow%20error%3B%7Dconsole.error('Fetch%20error%3A'%2Cerror)%3Bthrow%20error%3B%7D%7Dasync%20handleRateLimit()%7Bthis.retryCount%2B%2B%3Bif(this.retryCount%20%3E%20this.maxRetries)%7Bthrow%20new%20Error('Max%20retries%20exceeded%20for%20rate%20limiting')%3B%7Dif(this.ui)%7Bthis.ui.showError(%60Rate%20limited.%20Waiting...(Retry%20%24%7Bthis.retryCount%7D%2F%24%7Bthis.maxRetries%7D)%60)%3B%7Dawait%20this.delay(1200%2C1500)%3B%7Dasync%20run()%7Bif(typeof%20ScraperUI%20!%3D%3D%20'undefined')%7Bthis.ui%20%3D%20new%20ScraperUI()%3Bthis.ui.init()%3B%7Dconst%20csrfToken%20%3D%20getCsrfToken()%3Bif(!csrfToken%20%26%26%20this.ui)%7Bthis.ui.showError('Warning%3ANo%20CSRF%20token%20found.%20Continuing%20anyway...')%3B%7Dlet%20start%20%3D%200%3Bconst%20step%20%3D%2010%3Blet%20consecutiveEmptyPages%20%3D%200%3Bwhile(this.people.length%20%3C%20this.targetCount%20%26%26%20consecutiveEmptyPages%20%3C%203)%7Bif(this.ui)%7Bthis.ui.updateProgress(this.people.length%2Cthis.targetCount)%3B%7Dtry%7Bconst%20hasResults%20%3D%20await%20this.fetchPage(start)%3Bif(!hasResults)%7BconsecutiveEmptyPages%2B%2B%3B%7Delse%7BconsecutiveEmptyPages%20%3D%200%3Bthis.retryCount%20%3D%200%3B%7Dstart%20%2B%3D%20step%3Bif(this.people.length%20%3C%20this.targetCount)%7Bawait%20this.delay()%3B%7D%7Dcatch(error)%7Bif(error.message%20%3D%3D%3D%20'RATE_LIMIT')%7Bawait%20this.handleRateLimit()%3B%7Delse%7Bconsole.error('Error%20during%20scraping%3A'%2Cerror)%3Bif(this.ui)%7Bthis.ui.showError(%60Error%3A%24%7Berror.message%7D%60)%3B%7Dbreak%3B%7D%7D%7Dif(this.ui)%7Bthis.ui.updateProgress(this.people.length%2Cthis.people.length)%3Bthis.ui.enableExport(this.people)%3Bif(this.people.length%20%3D%3D%3D%200)%7Bthis.ui.showError('No%20results%20found.%20Try%20a%20different%20search.')%3B%7Delse%7Bconsole.log(%60Scraping%20complete.%20Found%20%24%7Bthis.people.length%7Dunique%20profiles.%60)%3B%7D%7Dreturn%20this.people%3B%7D%7Dif(typeof%20module%20!%3D%3D%20'undefined'%20%26%26%20module.exports)%7Bmodule.exports%20%3D%7BgetCsrfToken%2CsanitizeProfileUrl%2CparseFollowers%2CparseSummary%2CisNoiseEntry%2CnormalizePerson%2CextractPeopleFromResponse%2CLinkedInScraper%7D%3B%7Delse%7Bwindow.LinkedInScraper%20%3D%20LinkedInScraper%3Bwindow.LinkedInScraperCore%20%3D%7BgetCsrfToken%2CsanitizeProfileUrl%2CparseFollowers%2CparseSummary%2CisNoiseEntry%2CnormalizePerson%2CextractPeopleFromResponse%7D%3B%7D'use%20strict'%3Bclass%20ScraperUI%7Bconstructor()%7Bthis.container%20%3D%20null%3Bthis.progressBar%20%3D%20null%3Bthis.progressText%20%3D%20null%3Bthis.resultsCounter%20%3D%20null%3Bthis.resultsTable%20%3D%20null%3Bthis.resultsBody%20%3D%20null%3Bthis.exportButtons%20%3D%20null%3Bthis.errorMessage%20%3D%20null%3Bthis.people%20%3D%20%5B%5D%3B%7Dinit()%7Bif(document.getElementById('linkedin-scraper-ui'))%7Bthis.destroy()%3B%7Dthis.createStyles()%3Bthis.createContainer()%3Bthis.createHeader()%3Bthis.createProgressSection()%3Bthis.createResultsSection()%3Bthis.createExportSection()%3Bthis.attachEventListeners()%3Bdocument.body.appendChild(this.container)%3B%7DcreateStyles()%7Bconst%20style%20%3D%20document.createElement('style')%3Bstyle.textContent%20%3D%20%60%20%23linkedin-scraper-ui%7Bposition%3Afixed%3Btop%3A20px%3Bright%3A20px%3Bwidth%3A500px%3Bmax-height%3A80vh%3Bbackground%3Argba(26%2C32%2C44%2C0.95)%3Bborder%3A1px%20solid%20%234a5568%3Bborder-radius%3A8px%3Bbox-shadow%3A0%2010px%2040px%20rgba(0%2C0%2C0%2C0.5)%3Bz-index%3A9999%3Bfont-family%3Asystem-ui%2C-apple-system%2Csans-serif%3Bcolor%3A%23e2e8f0%3Bdisplay%3Aflex%3Bflex-direction%3Acolumn%3B%7D%23linkedin-scraper-ui%20*%7Bbox-sizing%3Aborder-box%3B%7D.scraper-header%7Bpadding%3A16px%3Bborder-bottom%3A1px%20solid%20%234a5568%3Bdisplay%3Aflex%3Bjustify-content%3Aspace-between%3Balign-items%3Acenter%3B%7D.scraper-title%7Bfont-size%3A18px%3Bfont-weight%3A600%3Bcolor%3A%2363b3ed%3B%7D.scraper-close%7Bbackground%3Atransparent%3Bborder%3Anone%3Bcolor%3A%23a0aec0%3Bfont-size%3A24px%3Bcursor%3Apointer%3Bpadding%3A0%3Bwidth%3A30px%3Bheight%3A30px%3Bdisplay%3Aflex%3Balign-items%3Acenter%3Bjustify-content%3Acenter%3B%7D.scraper-close%3Ahover%7Bcolor%3A%23f56565%3B%7D.scraper-progress%7Bpadding%3A16px%3Bborder-bottom%3A1px%20solid%20%234a5568%3B%7D.progress-bar-container%7Bbackground%3A%232d3748%3Bborder-radius%3A4px%3Bheight%3A8px%3Bmargin-bottom%3A8px%3Boverflow%3Ahidden%3B%7D.progress-bar%7Bbackground%3A%2348bb78%3Bheight%3A100%25%3Bwidth%3A0%25%3Btransition%3Awidth%200.3s%20ease%3B%7D.progress-text%7Bfont-size%3A14px%3Bcolor%3A%23a0aec0%3Btext-align%3Acenter%3B%7D.results-counter%7Bpadding%3A8px%2016px%3Bbackground%3A%232d3748%3Bfont-size%3A14px%3Bfont-weight%3A500%3B%7D.results-table-container%7Bmax-height%3A400px%3Boverflow-y%3Aauto%3Bflex%3A1%3B%7D.results-table%7Bwidth%3A100%25%3Bfont-size%3A13px%3B%7D.results-table%20th%7Bbackground%3A%232d3748%3Bpadding%3A8px%3Btext-align%3Aleft%3Bfont-weight%3A600%3Bposition%3Asticky%3Btop%3A0%3Bz-index%3A1%3B%7D.results-table%20td%7Bpadding%3A8px%3Bborder-bottom%3A1px%20solid%20%232d3748%3Bmax-width%3A150px%3Boverflow%3Ahidden%3Btext-overflow%3Aellipsis%3Bwhite-space%3Anowrap%3B%7D.results-table%20tr%3Ahover%7Bbackground%3Argba(56%2C178%2C172%2C0.1)%3B%7D.export-section%7Bpadding%3A16px%3Bborder-top%3A1px%20solid%20%234a5568%3Bdisplay%3Aflex%3Bgap%3A8px%3Bjustify-content%3Acenter%3B%7D.export-button%7Bbackground%3A%233182ce%3Bcolor%3Awhite%3Bpadding%3A8px%2016px%3Bborder-radius%3A4px%3Bborder%3Anone%3Bcursor%3Apointer%3Bfont-size%3A14px%3Bfont-weight%3A500%3Btransition%3Abackground%200.2s%3B%7D.export-button%3Ahover%3Anot(%3Adisabled)%7Bbackground%3A%232c5282%3B%7D.export-button%3Adisabled%7Bbackground%3A%234a5568%3Bcursor%3Anot-allowed%3Bopacity%3A0.6%3B%7D.error-message%7Bposition%3Aabsolute%3Bbottom%3A70px%3Bleft%3A16px%3Bright%3A16px%3Bbackground%3A%23f56565%3Bcolor%3Awhite%3Bpadding%3A8px%2012px%3Bborder-radius%3A4px%3Bfont-size%3A13px%3Bdisplay%3Anone%3Banimation%3AslideUp%200.3s%20ease%3B%7D%40keyframes%20slideUp%7Bfrom%7Btransform%3AtranslateY(20px)%3Bopacity%3A0%3B%7Dto%7Btransform%3AtranslateY(0)%3Bopacity%3A1%3B%7D%7D.results-table-container%3A%3A-webkit-scrollbar%7Bwidth%3A8px%3B%7D.results-table-container%3A%3A-webkit-scrollbar-track%7Bbackground%3A%232d3748%3B%7D.results-table-container%3A%3A-webkit-scrollbar-thumb%7Bbackground%3A%234a5568%3Bborder-radius%3A4px%3B%7D.results-table-container%3A%3A-webkit-scrollbar-thumb%3Ahover%7Bbackground%3A%23718096%3B%7D%60%3Bdocument.head.appendChild(style)%3B%7DcreateContainer()%7Bthis.container%20%3D%20document.createElement('div')%3Bthis.container.id%20%3D%20'linkedin-scraper-ui'%3B%7DcreateHeader()%7Bconst%20header%20%3D%20document.createElement('div')%3Bheader.className%20%3D%20'scraper-header'%3Bconst%20title%20%3D%20document.createElement('div')%3Btitle.className%20%3D%20'scraper-title'%3Btitle.textContent%20%3D%20'LinkedIn%20Scraper'%3Bconst%20closeBtn%20%3D%20document.createElement('button')%3BcloseBtn.className%20%3D%20'scraper-close'%3BcloseBtn.innerHTML%20%3D%20'%C3%97'%3BcloseBtn.onclick%20%3D()%3D%3E%20this.destroy()%3Bheader.appendChild(title)%3Bheader.appendChild(closeBtn)%3Bthis.container.appendChild(header)%3B%7DcreateProgressSection()%7Bconst%20progressSection%20%3D%20document.createElement('div')%3BprogressSection.className%20%3D%20'scraper-progress'%3Bconst%20barContainer%20%3D%20document.createElement('div')%3BbarContainer.className%20%3D%20'progress-bar-container'%3Bthis.progressBar%20%3D%20document.createElement('div')%3Bthis.progressBar.className%20%3D%20'progress-bar'%3BbarContainer.appendChild(this.progressBar)%3Bthis.progressText%20%3D%20document.createElement('div')%3Bthis.progressText.className%20%3D%20'progress-text'%3Bthis.progressText.textContent%20%3D%20'0%20of%200%20profiles'%3BprogressSection.appendChild(barContainer)%3BprogressSection.appendChild(this.progressText)%3Bthis.container.appendChild(progressSection)%3B%7DcreateResultsSection()%7Bthis.resultsCounter%20%3D%20document.createElement('div')%3Bthis.resultsCounter.className%20%3D%20'results-counter'%3Bthis.resultsCounter.textContent%20%3D%20'Found%3A0%20unique%20profiles'%3Bthis.container.appendChild(this.resultsCounter)%3Bconst%20tableContainer%20%3D%20document.createElement('div')%3BtableContainer.className%20%3D%20'results-table-container'%3Bthis.resultsTable%20%3D%20document.createElement('table')%3Bthis.resultsTable.className%20%3D%20'results-table'%3Bconst%20thead%20%3D%20document.createElement('thead')%3Bthead.innerHTML%20%3D%20%60%20%3Ctr%3E%20%3Cth%3EName%3C%2Fth%3E%20%3Cth%3EHeadline%3C%2Fth%3E%20%3Cth%3ELocation%3C%2Fth%3E%20%3Cth%3EFollowers%3C%2Fth%3E%20%3C%2Ftr%3E%20%60%3Bthis.resultsBody%20%3D%20document.createElement('tbody')%3Bthis.resultsTable.appendChild(thead)%3Bthis.resultsTable.appendChild(this.resultsBody)%3BtableContainer.appendChild(this.resultsTable)%3Bthis.container.appendChild(tableContainer)%3B%7DcreateExportSection()%7Bconst%20exportSection%20%3D%20document.createElement('div')%3BexportSection.className%20%3D%20'export-section'%3Bconst%20csvButton%20%3D%20document.createElement('button')%3BcsvButton.className%20%3D%20'export-button'%3BcsvButton.textContent%20%3D%20'Export%20CSV'%3BcsvButton.disabled%20%3D%20true%3BcsvButton.onclick%20%3D()%3D%3E%7Bif(typeof%20exportToCsv%20%3D%3D%3D%20'function')%7BexportToCsv(this.people)%3B%7D%7D%3Bconst%20htmlButton%20%3D%20document.createElement('button')%3BhtmlButton.className%20%3D%20'export-button'%3BhtmlButton.textContent%20%3D%20'Export%20HTML'%3BhtmlButton.disabled%20%3D%20true%3BhtmlButton.onclick%20%3D()%3D%3E%7Bif(typeof%20exportToHtml%20%3D%3D%3D%20'function')%7BexportToHtml(this.people)%3B%7D%7D%3BexportSection.appendChild(csvButton)%3BexportSection.appendChild(htmlButton)%3Bthis.exportButtons%20%3D%20%5BcsvButton%2ChtmlButton%5D%3Bthis.container.appendChild(exportSection)%3Bthis.errorMessage%20%3D%20document.createElement('div')%3Bthis.errorMessage.className%20%3D%20'error-message'%3Bthis.container.appendChild(this.errorMessage)%3B%7DattachEventListeners()%7Bthis.container.addEventListener('mousedown'%2C(e)%3D%3E%7Be.stopPropagation()%3B%7D)%3B%7DupdateProgress(current%2Ctotal)%7Bconst%20percentage%20%3D%20total%20%3E%200%20%3F(current%20%2F%20total)*%20100%3A0%3Bthis.progressBar.style.width%20%3D%20%60%24%7Bpercentage%7D%25%60%3Bthis.progressText.textContent%20%3D%20%60%24%7Bcurrent%7Dof%20%24%7Btotal%7Dprofiles%60%3Bthis.resultsCounter.textContent%20%3D%20%60Found%3A%24%7Bcurrent%7Dunique%20profiles%60%3B%7DaddRow(person)%7Bthis.people.push(person)%3Bconst%20row%20%3D%20document.createElement('tr')%3Bconst%20nameCell%20%3D%20document.createElement('td')%3BnameCell.textContent%20%3D%20person.name%20%7C%7C%20'-'%3BnameCell.title%20%3D%20person.name%20%7C%7C%20''%3Bconst%20headlineCell%20%3D%20document.createElement('td')%3BheadlineCell.textContent%20%3D%20person.headline%20%7C%7C%20'-'%3BheadlineCell.title%20%3D%20person.headline%20%7C%7C%20''%3Bconst%20locationCell%20%3D%20document.createElement('td')%3BlocationCell.textContent%20%3D%20person.location%20%7C%7C%20'-'%3BlocationCell.title%20%3D%20person.location%20%7C%7C%20''%3Bconst%20followersCell%20%3D%20document.createElement('td')%3BfollowersCell.textContent%20%3D%20person.followers%20%3F%20person.followers.toLocaleString()%3A'-'%3Brow.appendChild(nameCell)%3Brow.appendChild(headlineCell)%3Brow.appendChild(locationCell)%3Brow.appendChild(followersCell)%3Bthis.resultsBody.appendChild(row)%3Bthis.resultsCounter.textContent%20%3D%20%60Found%3A%24%7Bthis.people.length%7Dunique%20profiles%60%3B%7DshowError(message)%7Bthis.errorMessage.textContent%20%3D%20message%3Bthis.errorMessage.style.display%20%3D%20'block'%3BsetTimeout(()%3D%3E%7Bthis.errorMessage.style.display%20%3D%20'none'%3B%7D%2C5000)%3B%7DenableExport(people)%7Bif(people)%7Bthis.people%20%3D%20people%3B%7Dthis.exportButtons.forEach(btn%20%3D%3E%7Bbtn.disabled%20%3D%20false%3B%7D)%3B%7Ddestroy()%7Bif(this.container%20%26%26%20this.container.parentNode)%7Bthis.container.parentNode.removeChild(this.container)%3B%7Dconst%20style%20%3D%20document.querySelector('style')%3Bif(style%20%26%26%20style.textContent.includes('%23linkedin-scraper-ui'))%7Bstyle.parentNode.removeChild(style)%3B%7D%7D%7Dif(typeof%20module%20!%3D%3D%20'undefined'%20%26%26%20module.exports)%7Bmodule.exports%20%3D%20ScraperUI%3B%7Delse%7Bwindow.ScraperUI%20%3D%20ScraperUI%3B%7D'use%20strict'%3Bfunction%20escapeCSV(value)%7Bif(value%20%3D%3D%3D%20null%20%7C%7C%20value%20%3D%3D%3D%20undefined)%7Breturn%20''%3B%7Dconst%20str%20%3D%20String(value)%3Bif(str.includes('%2C')%7C%7C%20str.includes('%22')%7C%7C%20str.includes('%5Cn')%7C%7C%20str.includes('%5Cr'))%7Breturn%20'%22'%20%2B%20str.replace(%2F%22%2Fg%2C'%22%22')%2B%20'%22'%3B%7Dreturn%20str%3B%7Dfunction%20exportToCsv(people)%7Bif(!people%20%7C%7C%20people.length%20%3D%3D%3D%200)%7Balert('No%20data%20to%20export')%3Breturn%3B%7Dconst%20BOM%20%3D%20'%5CuFEFF'%3Bconst%20headers%20%3D%20%5B'Name'%2C'Profile%20URL'%2C'Headline'%2C'Location'%2C'Current%20Companies'%2C'Past%20Companies'%2C'Followers'%5D%3Bconst%20csvContent%20%3D%20BOM%20%2B%20headers.map(escapeCSV).join('%2C')%2B%20'%5Cn'%20%2B%20people.map(person%20%3D%3E%7Breturn%20%5B%20person.name%20%7C%7C%20''%2Cperson.profileUrl%20%7C%7C%20''%2Cperson.headline%20%7C%7C%20''%2Cperson.location%20%7C%7C%20''%2C(person.summaryCurrent%20%7C%7C%20%5B%5D).join('%3B')%2C(person.summaryPast%20%7C%7C%20%5B%5D).join('%3B')%2Cperson.followers%20%7C%7C%20''%20%5D.map(escapeCSV).join('%2C')%3B%7D).join('%5Cn')%3Bconst%20timestamp%20%3D%20new%20Date().toISOString().split('T')%5B0%5D%3Bconst%20filename%20%3D%20%60linkedin_profiles_%24%7Btimestamp%7D.csv%60%3BdownloadFile(csvContent%2Cfilename%2C'text%2Fcsv%3Bcharset%3Dutf-8')%3B%7Dfunction%20exportToHtml(people)%7Bif(!people%20%7C%7C%20people.length%20%3D%3D%3D%200)%7Balert('No%20data%20to%20export')%3Breturn%3B%7Dconst%20escapeHtml%20%3D(str)%3D%3E%7Bconst%20div%20%3D%20document.createElement('div')%3Bdiv.textContent%20%3D%20str%20%7C%7C%20''%3Breturn%20div.innerHTML%3B%7D%3Bconst%20htmlContent%20%3D%20%60%3C!DOCTYPE%20html%3E%20%3Chtml%20lang%3D%22en%22%3E%20%3Chead%3E%20%3Cmeta%20charset%3D%22UTF-8%22%3E%20%3Cmeta%20name%3D%22viewport%22%20content%3D%22width%3Ddevice-width%2Cinitial-scale%3D1.0%22%3E%20%3Ctitle%3ELinkedIn%20Profiles%20Export%3C%2Ftitle%3E%20%3Cstyle%3E%20*%7Bmargin%3A0%3Bpadding%3A0%3Bbox-sizing%3Aborder-box%3B%7Dbody%7Bfont-family%3A-apple-system%2CBlinkMacSystemFont%2C'Segoe%20UI'%2CRoboto%2COxygen%2CUbuntu%2Csans-serif%3Bbackground%3A%23f7fafc%3Bpadding%3A20px%3Bcolor%3A%232d3748%3B%7D.container%7Bmax-width%3A1400px%3Bmargin%3A0%20auto%3Bbackground%3Awhite%3Bborder-radius%3A8px%3Bbox-shadow%3A0%201px%203px%20rgba(0%2C0%2C0%2C0.1)%3Boverflow%3Ahidden%3B%7Dh1%7Bbackground%3A%230077b5%3Bcolor%3Awhite%3Bpadding%3A20px%3Bfont-size%3A24px%3B%7D.meta%7Bpadding%3A15px%2020px%3Bbackground%3A%23f7fafc%3Bborder-bottom%3A1px%20solid%20%23e2e8f0%3Bfont-size%3A14px%3Bcolor%3A%23718096%3B%7Dtable%7Bwidth%3A100%25%3Bborder-collapse%3Acollapse%3B%7Dth%7Bbackground%3A%23edf2f7%3Bpadding%3A12px%3Btext-align%3Aleft%3Bfont-weight%3A600%3Bcolor%3A%234a5568%3Bborder-bottom%3A2px%20solid%20%23cbd5e0%3Bposition%3Asticky%3Btop%3A0%3B%7Dtd%7Bpadding%3A12px%3Bborder-bottom%3A1px%20solid%20%23e2e8f0%3B%7Dtr%3Ahover%7Bbackground%3A%23f7fafc%3B%7D.profile-link%7Bcolor%3A%230077b5%3Btext-decoration%3Anone%3Bfont-weight%3A500%3B%7D.profile-link%3Ahover%7Btext-decoration%3Aunderline%3B%7D.followers%7Btext-align%3Aright%3Bfont-weight%3A500%3Bcolor%3A%232d3748%3B%7D.companies%7Bfont-size%3A13px%3Bcolor%3A%23718096%3B%7D.no-data%7Bcolor%3A%23a0aec0%3Bfont-style%3Aitalic%3B%7D%40media%20print%7Bbody%7Bpadding%3A0%3B%7D.container%7Bbox-shadow%3Anone%3B%7D%7D%3C%2Fstyle%3E%20%3C%2Fhead%3E%20%3Cbody%3E%20%3Cdiv%20class%3D%22container%22%3E%20%3Ch1%3ELinkedIn%20Profiles%20Export%3C%2Fh1%3E%20%3Cdiv%20class%3D%22meta%22%3E%20%3Cstrong%3EExport%20Date%3A%3C%2Fstrong%3E%20%24%7Bnew%20Date().toLocaleDateString()%7D%7C%20%3Cstrong%3ETotal%20Profiles%3A%3C%2Fstrong%3E%20%24%7Bpeople.length%7D%3C%2Fdiv%3E%20%3Ctable%3E%20%3Cthead%3E%20%3Ctr%3E%20%3Cth%3EName%3C%2Fth%3E%20%3Cth%3EHeadline%3C%2Fth%3E%20%3Cth%3ELocation%3C%2Fth%3E%20%3Cth%3ECurrent%20Companies%3C%2Fth%3E%20%3Cth%3EPast%20Companies%3C%2Fth%3E%20%3Cth%3EFollowers%3C%2Fth%3E%20%3C%2Ftr%3E%20%3C%2Fthead%3E%20%3Ctbody%3E%20%24%7Bpeople.map(person%20%3D%3E%20%60%20%3Ctr%3E%20%3Ctd%3E%20%24%7Bperson.profileUrl%20%3F%20%60%3Ca%20href%3D%22%24%7BescapeHtml(person.profileUrl)%7D%22%20target%3D%22_blank%22%20class%3D%22profile-link%22%3E%24%7BescapeHtml(person.name%20%7C%7C%20'Unknown')%7D%3C%2Fa%3E%60%3AescapeHtml(person.name%20%7C%7C%20'Unknown')%7D%3C%2Ftd%3E%20%3Ctd%3E%24%7BescapeHtml(person.headline)%7C%7C%20'%3Cspan%20class%3D%22no-data%22%3E-%3C%2Fspan%3E'%7D%3C%2Ftd%3E%20%3Ctd%3E%24%7BescapeHtml(person.location)%7C%7C%20'%3Cspan%20class%3D%22no-data%22%3E-%3C%2Fspan%3E'%7D%3C%2Ftd%3E%20%3Ctd%20class%3D%22companies%22%3E%20%24%7Bperson.summaryCurrent%20%26%26%20person.summaryCurrent.length%20%3E%200%20%3F%20escapeHtml(person.summaryCurrent.join('%2C'))%3A'%3Cspan%20class%3D%22no-data%22%3E-%3C%2Fspan%3E'%7D%3C%2Ftd%3E%20%3Ctd%20class%3D%22companies%22%3E%20%24%7Bperson.summaryPast%20%26%26%20person.summaryPast.length%20%3E%200%20%3F%20escapeHtml(person.summaryPast.join('%2C'))%3A'%3Cspan%20class%3D%22no-data%22%3E-%3C%2Fspan%3E'%7D%3C%2Ftd%3E%20%3Ctd%20class%3D%22followers%22%3E%20%24%7Bperson.followers%20%3F%20person.followers.toLocaleString()%3A'%3Cspan%20class%3D%22no-data%22%3E-%3C%2Fspan%3E'%7D%3C%2Ftd%3E%20%3C%2Ftr%3E%20%60).join('')%7D%3C%2Ftbody%3E%20%3C%2Ftable%3E%20%3C%2Fdiv%3E%20%3C%2Fbody%3E%20%3C%2Fhtml%3E%60%3Bconst%20timestamp%20%3D%20new%20Date().toISOString().split('T')%5B0%5D%3Bconst%20filename%20%3D%20%60linkedin_profiles_%24%7Btimestamp%7D.html%60%3BdownloadFile(htmlContent%2Cfilename%2C'text%2Fhtml%3Bcharset%3Dutf-8')%3B%7Dfunction%20downloadFile(content%2Cfilename%2CmimeType)%7Bconst%20blob%20%3D%20new%20Blob(%5Bcontent%5D%2C%7Btype%3AmimeType%7D)%3Bconst%20url%20%3D%20URL.createObjectURL(blob)%3Bconst%20link%20%3D%20document.createElement('a')%3Blink.href%20%3D%20url%3Blink.download%20%3D%20filename%3Blink.style.display%20%3D%20'none'%3Bdocument.body.appendChild(link)%3Blink.click()%3BsetTimeout(()%3D%3E%7Bdocument.body.removeChild(link)%3BURL.revokeObjectURL(url)%3B%7D%2C100)%3B%7Dif(typeof%20module%20!%3D%3D%20'undefined'%20%26%26%20module.exports)%7Bmodule.exports%20%3D%7BexportToCsv%2CexportToHtml%2CdownloadFile%7D%3B%7Delse%7Bwindow.exportToCsv%20%3D%20exportToCsv%3Bwindow.exportToHtml%20%3D%20exportToHtml%3Bwindow.downloadFile%20%3D%20downloadFile%3B%7Dif(window.__linkedInScraperRunning__)%7Balert('Scraper%20already%20running!')%3Breturn%3B%7Dwindow.__linkedInScraperRunning__%3Dtrue%3Bif(!window.location.href.includes('linkedin.com%2Fsearch%2Fresults%2Fpeople'))%7Balert('Please%20navigate%20to%20LinkedIn%20People%20search%20results%20first')%3Bwindow.__linkedInScraperRunning__%3Dfalse%3Breturn%3B%7Dconst%20targetCount%3Dprompt('How%20many%20profiles%20to%20scrape%3F'%2C'300')%3Bif(!targetCount)%7Bwindow.__linkedInScraperRunning__%3Dfalse%3Breturn%3B%7Dconst%20scraper%3Dnew%20LinkedInScraper(parseInt(targetCount)%7C%7C300)%3Bscraper.run().catch(e%3D%3E%7Bconsole.error('Scraper%20error%3A'%2Ce)%3Balert('Error%3A'%2Be.message)%3B%7D).finally(()%3D%3E%7Bwindow.__linkedInScraperRunning__%3Dfalse%3B%7D)%3B%7D)()